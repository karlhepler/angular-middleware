!function(e){"use strict";var r={},t=!1,n={middleware:[]},o=["$injector","$q",function(o,i){function a(e){return!!t||!u(e)}function u(e){return s(n)||s(e)}function s(e){var r=d(e);return!!r&&!!r.length}function d(e){return e.middleware||((e.data||{}).vars||{}).middleware}function f(e){for(var r=[],t=0;t<e.length;t++)r=r.concat(l(e[t]));return r}function l(e){var r=d(e);return r instanceof Array?r:"undefined"==typeof r?[]:r.split("|")}function c(){var e=r[v.names[v.index++]];e&&o.invoke(e,$)}function p(){v.index==v.names.length&&v.resolution.resolve(),v.next()}function m(e,r,t){v.resolution.reject({type:"redirectTo",route:e,params:r,options:t})}var v={next:c},$={next:p,redirectTo:m};return function(r,t){return a(r)?i.resolve():($.params=e.copy(t),$.route=r.name,v.index=0,v.names=f([n,r]),v.resolution=i.defer(),v.next(),v.resolution.promise)}}],i=function(){this.map=function(e){if("object"!=typeof e)throw"Your middleware map must be an object!";r=e},this.bypassAll=function(e){if("boolean"!=typeof e)throw"You must provide bypassAll with a boolean value!";t=e},this.global=function(r){if("string"!=typeof r&&!e.isArray(r))throw"You must provide a string, a string separated by pipes, or an array of middleware names";n.middleware=r},this.$get=o};e.module("ngRoute.middleware",[]).provider("$middleware",i).config(["$provide",function(r){r.decorator("$route",["$delegate",function(r){return e.forEach(r.routes,function(e){e.resolve=e.resolve||{}}),r}])}]).run(["$rootScope","$route","$location","$middleware",function(e,r,t,n){e.$on("$routeChangeStart",function(e,r,t){r.resolve.middleware=function(){return n(r,r.params)}}),e.$on("$routeChangeError",function(e,n,o,i){if("redirectTo"===i.type){if(e.preventDefault(),n.regexp.test(i.route))return r.reload();t.path(i.route),i.params&&t.search(i.params)}})}]),e.module("ui.router.middleware",[]).provider("$middleware",i).config(["$stateProvider",function(e){e.decorator("path",function(e,r){return"undefined"==typeof e.self.resolve&&(e.self.resolve={},e.resolve=e.self.resolve),r(e)})}]).run(["$rootScope","$state","$middleware",function(e,r,t){e.$on("$stateChangeStart",function(e,r,n){r.resolve.middleware=function(){return t(r,n)}}),e.$on("$stateChangeError",function(e,t,n,o,i,a){if("redirectTo"===a.type){e.preventDefault();var u=a.options||{location:!0,inherit:!1,relative:r.$current,notify:!0,reload:!0};return r.transitionTo(a.route,a.params,u)}})}])}(angular);